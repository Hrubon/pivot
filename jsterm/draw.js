let data = {
  "name": "G",
  "directed": false,
  "strict": false,
  "_draw_": 
  [
    {
      "op": "c",
      "grad": "none",
      "color": "#fffffe00"
    },
    {
      "op": "C",
      "grad": "none",
      "color": "#ffffff"
    },
    {
      "op": "P",
      "points": [[0.000,0.000],[0.000,706.860],[751.500,706.860],[751.500,0.000]]
    }
  ],
  "bb": "0,0,751.5,706.86",
  "overlap": "false",
  "sep": "+20",
  "xdotversion": "1.7",
  "_subgraph_cnt": 0,
  "objects": [
    {
      "_gvid": 0,
      "name": "net0",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[451.960,562.390],[344.960,562.390],[344.960,526.390],[451.960,526.390]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [398.460,540.690],
          "align": "c",
          "width": 91.000,
          "text": "10.0.10.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.10.0\/24",
      "pos": "398.46,544.39",
      "shape": "box",
      "width": "1.4861"
    },
    {
      "_gvid": 1,
      "name": "router0",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "e",
          "rect": [274.070,446.990,48.990,18.000]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [274.070,443.290],
          "align": "c",
          "width": 59.000,
          "text": "10.0.0.1"
        }
      ],
      "height": "0.5",
      "label": "10.0.0.1",
      "pos": "274.07,446.99",
      "width": "1.354"
    },
    {
      "_gvid": 2,
      "name": "net1",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[357.570,302.510],[259.570,302.510],[259.570,266.510],[357.570,266.510]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [308.570,280.810],
          "align": "c",
          "width": 82.000,
          "text": "10.0.0.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.0.0\/24",
      "pos": "308.57,284.51",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 3,
      "name": "net2",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[174.090,488.090],[76.090,488.090],[76.090,452.090],[174.090,452.090]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [125.090,466.390],
          "align": "c",
          "width": 82.000,
          "text": "10.0.2.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.2.0\/24",
      "pos": "125.09,470.09",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 4,
      "name": "net3",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[247.610,600.670],[149.610,600.670],[149.610,564.670],[247.610,564.670]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [198.610,578.970],
          "align": "c",
          "width": 82.000,
          "text": "10.0.1.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.1.0\/24",
      "pos": "198.61,582.67",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 5,
      "name": "router4",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "e",
          "rect": [197.850,168.750,48.990,18.000]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [197.850,165.050],
          "align": "c",
          "width": 59.000,
          "text": "10.0.0.2"
        }
      ],
      "height": "0.5",
      "label": "10.0.0.2",
      "pos": "197.85,168.75",
      "width": "1.354"
    },
    {
      "_gvid": 6,
      "name": "net5",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[98.000,162.740],[0.000,162.740],[0.000,126.740],[98.000,126.740]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [49.000,141.040],
          "align": "c",
          "width": 82.000,
          "text": "10.0.3.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.3.0\/24",
      "pos": "49,144.74",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 7,
      "name": "net6",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[233.700,36.000],[135.700,36.000],[135.700,0.000],[233.700,0.000]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [184.700,14.300],
          "align": "c",
          "width": 82.000,
          "text": "10.0.4.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.4.0\/24",
      "pos": "184.7,18",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 8,
      "name": "net7",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[615.180,401.870],[517.180,401.870],[517.180,365.870],[615.180,365.870]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [566.180,380.170],
          "align": "c",
          "width": 82.000,
          "text": "10.0.6.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.6.0\/24",
      "pos": "566.18,383.87",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 9,
      "name": "router7",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "e",
          "rect": [472.670,256.680,48.990,18.000]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [472.670,252.980],
          "align": "c",
          "width": 59.000,
          "text": "10.0.0.3"
        }
      ],
      "height": "0.5",
      "label": "10.0.0.3",
      "pos": "472.67,256.68",
      "width": "1.354"
    },
    {
      "_gvid": 10,
      "name": "net9",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[659.530,202.670],[561.530,202.670],[561.530,166.670],[659.530,166.670]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [610.530,180.970],
          "align": "c",
          "width": 82.000,
          "text": "10.0.5.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.5.0\/24",
      "pos": "610.53,184.67",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 11,
      "name": "net10",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[549.270,126.660],[451.270,126.660],[451.270,90.660],[549.270,90.660]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [500.270,104.960],
          "align": "c",
          "width": 82.000,
          "text": "10.0.7.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.7.0\/24",
      "pos": "500.27,108.66",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 12,
      "name": "router11",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "e",
          "rect": [553.800,538.880,48.990,18.000]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [553.800,535.180],
          "align": "c",
          "width": 59.000,
          "text": "10.0.6.2"
        }
      ],
      "height": "0.5",
      "label": "10.0.6.2",
      "pos": "553.8,538.88",
      "width": "1.354"
    },
    {
      "_gvid": 13,
      "name": "net13",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[751.500,588.620],[653.500,588.620],[653.500,552.620],[751.500,552.620]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [702.500,566.920],
          "align": "c",
          "width": 82.000,
          "text": "10.0.8.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.8.0\/24",
      "pos": "702.5,570.62",
      "shape": "box",
      "width": "1.3611"
    },
    {
      "_gvid": 14,
      "name": "net14",
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "p",
          "points": [[628.050,706.860],[530.050,706.860],[530.050,670.860],[628.050,670.860]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [579.050,685.160],
          "align": "c",
          "width": 82.000,
          "text": "10.0.9.0\/24"
        }
      ],
      "height": "0.5",
      "label": "10.0.9.0\/24",
      "pos": "579.05,688.86",
      "shape": "box",
      "width": "1.3611"
    }
  ],
  "edges": [
    {
      "_gvid": 0,
      "tail": 1,
      "head": 0,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[294.890,463.290],[317.160,480.730],[352.380,508.310],[375.460,526.370]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [325.680,498.630],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "325.68,502.33",
      "pos": "294.89,463.29 317.16,480.73 352.38,508.31 375.46,526.37"
    },
    {
      "_gvid": 1,
      "tail": 1,
      "head": 2,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[277.900,428.980],[284.530,397.750],[298.090,333.890],[304.730,302.600]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [281.820,369.590],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "281.82,373.29",
      "pos": "277.9,428.98 284.53,397.75 298.09,333.89 304.73,302.6"
    },
    {
      "_gvid": 2,
      "tail": 1,
      "head": 3,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[228.970,453.980],[211.670,456.660],[191.850,459.740],[174.200,462.480]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [192.080,462.030],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "192.08,465.73",
      "pos": "228.97,453.98 211.67,456.66 191.85,459.74 174.2,462.48"
    },
    {
      "_gvid": 3,
      "tail": 1,
      "head": 4,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[264.210,464.730],[249.830,490.580],[223.240,538.390],[208.720,564.490]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [226.970,518.410],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "226.97,522.11",
      "pos": "264.21,464.73 249.83,490.58 223.24,538.39 208.72,564.49"
    },
    {
      "_gvid": 4,
      "tail": 5,
      "head": 2,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[214.180,185.830],[234.760,207.340],[269.960,244.140],[291.070,266.210]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [243.130,229.820],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "243.13,233.52",
      "pos": "214.18,185.83 234.76,207.34 269.96,244.14 291.07,266.21"
    },
    {
      "_gvid": 5,
      "tail": 5,
      "head": 6,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[152.780,161.480],[135.500,158.690],[115.700,155.500],[98.060,152.650]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [115.920,160.860],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "115.92,164.56",
      "pos": "152.78,161.48 135.5,158.69 115.7,155.5 98.058,152.65"
    },
    {
      "_gvid": 6,
      "tail": 5,
      "head": 7,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[196.260,150.560],[193.730,121.590],[188.820,65.260],[186.290,36.250]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [181.780,97.210],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "181.78,100.91",
      "pos": "196.26,150.56 193.73,121.59 188.82,65.263 186.29,36.248"
    },
    {
      "_gvid": 7,
      "tail": 9,
      "head": 2,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[428.260,264.210],[406.430,267.910],[380.060,272.380],[357.640,276.190]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [383.450,274.000],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "383.45,277.7",
      "pos": "428.26,264.21 406.43,267.91 380.06,272.38 357.64,276.19"
    },
    {
      "_gvid": 8,
      "tail": 9,
      "head": 8,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[485.470,274.100],[503.180,298.180],[534.980,341.440],[552.920,365.840]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [509.700,323.770],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "509.7,327.47",
      "pos": "485.47,274.1 503.18,298.18 534.98,341.44 552.92,365.84"
    },
    {
      "_gvid": 9,
      "tail": 9,
      "head": 10,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[500.900,241.930],[522.640,230.570],[552.800,214.820],[575.980,202.710]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [528.940,226.120],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "528.94,229.82",
      "pos": "500.9,241.93 522.64,230.57 552.8,214.82 575.98,202.71"
    },
    {
      "_gvid": 10,
      "tail": 9,
      "head": 11,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[476.050,238.530],[481.350,210.120],[491.540,155.460],[496.850,126.960]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [476.950,186.540],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "476.95,190.24",
      "pos": "476.05,238.53 481.35,210.12 491.54,155.46 496.85,126.96"
    },
    {
      "_gvid": 11,
      "tail": 12,
      "head": 0,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[505.080,540.600],[488.260,541.200],[469.330,541.870],[452.140,542.480]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [469.110,545.340],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "469.11,549.04",
      "pos": "505.08,540.6 488.26,541.2 469.33,541.87 452.14,542.48"
    },
    {
      "_gvid": 12,
      "tail": 12,
      "head": 8,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[555.250,520.790],[557.620,491.080],[562.310,432.270],[564.710,402.320]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [550.480,465.360],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "550.48,469.06",
      "pos": "555.25,520.79 557.62,491.08 562.31,432.27 564.71,402.32"
    },
    {
      "_gvid": 13,
      "tail": 12,
      "head": 13,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[596.010,547.890],[613.870,551.700],[634.790,556.170],[653.340,560.130]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [615.180,557.810],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "615.18,561.51",
      "pos": "596.01,547.89 613.87,551.7 634.79,556.17 653.34,560.13"
    },
    {
      "_gvid": 14,
      "tail": 12,
      "head": 14,
      "_draw_": 
      [
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "b",
          "points": [[556.850,556.970],[561.700,585.800],[571.130,641.840],[575.990,670.710]]
        }
      ],
      "_ldraw_": 
      [
        {
          "op": "F",
          "size": 14.000,
          "face": "Times-Roman"
        },
        {
          "op": "c",
          "grad": "none",
          "color": "#000000"
        },
        {
          "op": "T",
          "pt": [556.920,617.640],
          "align": "c",
          "width": 19.000,
          "text": "10"
        }
      ],
      "label": "10",
      "lp": "556.92,621.34",
      "pos": "556.85,556.97 561.7,585.8 571.13,641.84 575.99,670.71"
    }
  ]
}

var zoomf = 1;
var margin = zoomf * 2;
var c = document.getElementById("myCanvas");
var dragdrop = false;
var ctx = c.getContext("2d");

let bb = data.bb.split(',').map(s => Math.floor(parseFloat(s)));
let width = bb[2], height = bb[3];
c.width = Math.floor(zoomf * width + 2 * margin);
c.height = Math.floor(zoomf * height + 2 * margin);
//ctx.translate(margin, margin);
ctx.scale(zoomf, zoomf);

var active;
c.addEventListener('mousedown', function(e) {
	var rect = e.target.getBoundingClientRect();
	var x = e.clientX - rect.left; //x position within the element.
	var y = e.clientY - rect.top;  //y position within the element.
	active = findHoverPgon(x, y);
	redraw();
}, true);
c.addEventListener('mouseup', function(e) {
	startX = startY = undefined;
	active = undefined;
	redraw();
}, true);

function findHoverPgon(x, y) {
	for (let i = 0; i < pgons.length; i++)
		if (pgons[i].isInside(x, y))
			return pgons[i];
}

var startX, startY;
c.addEventListener('mousemove', function(e) {
	var rect = e.target.getBoundingClientRect();
	var x = e.clientX - rect.left;
	var y = e.clientY - rect.top;
	if (active) {
		if (startX == undefined) {
			startX = x;
			startY = y;
		}
		dx = x - startX;
		dy = y - startY;
		for (let i = 0; i < active.pts.length; i++) {
			active.pts[i][0] += dx;
			active.pts[i][1] += dy;
		}
		startX = x;
		startY = y;
	}
	redraw();
	//console.log("Active poly:", active);
}, true);

var fsize;

class Polygon {
	constructor(pts, fill=false) {
		this.pts = pts;
		this.fill = fill;
		this.acitve = false;
	}

	draw(ctx) {
		ctx.save();
		ctx.beginPath();
		ctx.moveTo(...this.pts[0]);
		ctx.strokeStyle = this.active ? '#ff0000' : '#000000';
		for (let j = 1; j < this.pts.length; j++) {
			ctx.lineTo(...this.pts[j]);
		}
		ctx.closePath();
		if (this.fill)
			ctx.fill();
		else
			ctx.stroke()
		ctx.restore();
	}

	crosses(ux0, uy0, ux1, uy1, vx0, vy0, vx1, vy1) {
		let a = uy1 - uy0;
		let b = ux0 - ux1;
		let c = ux1 * uy0 - ux0 * uy1;
		let d1 = a * vx0 + b * vy0 + c;
		let d2 = a * vx1 + b * vy1 + c;
		return (d1 > 0 && d2 < 0) || (d1 < 0 && d2 > 0);
	}

	isInside(x, y) {
		let intersect = 0;
		let xmin = Number.POSITIVE_INFINITY;
		for (let i = 0; i < this.pts.length; i++) {
			if (this.pts[i][0] < xmin)
				xmin = this.pts[i][0];
		}
		let rx0 = xmin - 2, ry0 = y - 2, rx1 = x, ry1 = y;
		for (let i = 0, j = 1; i < this.pts.length; i++, j++) {
			if (j == this.pts.length)
				j = 0;
			if (this.crosses(rx0, ry0, rx1, ry1, ...this.pts[i], ...this.pts[j])
				&& this.crosses(...this.pts[i], ...this.pts[j], rx0, ry0, rx1, ry1))
				intersect++; // TODO collinearity!
		}
		return intersect % 2 == 1;
	}
}

var pgons = [];

class Ellipse {
	constructor(x, y, a, b) {
		this.x = x;
		this.y = y;
		this.a = a;
		this.b = b;
	}

	draw(ctx) {
		ctx.beginPath();
		ctx.ellipse(this.x, this.y, this.a, this.b, 0, 0, 2 * Math.PI, false);
		ctx.closePath();
		ctx.stroke();
	}
}

class Text {
	constructor(pt, text) {
		this.pt = pt;
		this.text = text;
	}

	draw(ctx) {
		ctx.save();
		ctx.translate(...this.pt);
		ctx.fillText(this.text, 0, 0);
		ctx.restore();
	}
}

class BSpline {
	constructor(pts) {
		this.pts = pts;
	}

	draw(ctx) {
		ctx.beginPath();
		ctx.moveTo(...this.pts[0]);
		for (let j = 1; j < this.pts.length; j++)
			ctx.lineTo(...this.pts[j]);
		ctx.stroke();
	}
}

var elems = [];

function drawit(objs, prop) {
	for (let o = 0; o < objs.length; o++) {
		let obj = objs[o];
		let draw = obj[prop];
		if (!draw)
			return;
		let pos = obj.pos;
		let [x0, y0] = pos.split(',').map(s => parseFloat(s));
		let pts;
		for (let i = 0; i < draw.length; i++) {
			let op = draw[i].op;
			switch (op) {
				case "p":
				case "P":
					pts = draw[i].points;
					for (let k = 0; k < pts.length; k++)
						pts[k][1] = height - pts[k][1];
					poly = new Polygon(pts, op == "P");
					elems.push(poly);
					pgons.push(poly);
					break;

				case "e":
					r = draw[i].rect;
					r[1] = height - r[1];
					ell = new Ellipse(...r);
					elems.push(ell);
					break;

				case "b":
					pts = draw[i].points;
					for (let k = 0; k < pts.length; k++)
						pts[k][1] = height - pts[k][1];
					bsp = new BSpline(pts);
					elems.push(bsp);
					break;
				case "F":
					fsize = Math.floor(draw[i].size)
					ctx.font = fsize + "px " + draw[i].face;
					ctx.textAlign = "center";
					break;
				case "T":
					draw[i].pt[1] = height - draw[i].pt[1];
					txt = new Text(draw[i].pt, draw[i].text);
					elems.push(txt);
					break;
			}
		}
	}
}

drawit(data.objects, '_draw_');
drawit(data.objects, '_ldraw_');
drawit(data.edges, '_draw_');
drawit(data.edges, '_hdraw_');
drawit(data.edges, '_ldraw_');

function redraw() {
	ctx.clearRect(0, 0, c.width, c.height);
	ctx.moveTo(0, 0);
	for (let i = 0; i < elems.length; i++) {
		elems[i].active = (active == elems[i]);
		elems[i].draw(ctx);
	}
}

redraw();
